# Определение рыночной стоимости автомобилей

## Задача

Сервис по продаже автомобилей с пробегом  разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. На основе исторических данных необходимо построить модель для определения стоимости автомобиля.

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

## Описание проекта

Сырые данные были предобработаны, неинформативные признаки удалены, проаналазированы распределения и аномалии датасета. Для обучения моделей были подготовлены выборки - категориальные признаки закодированы с помощью OneHotEncoder, а числовые стандартизированы. 

Для решения задачи были протестированы модели линейной регрессии с регуляризацией (так как в данных была замечена мультиколлинеарность) и модели градиентного бустинга CatBoost и LightGBM с подобранными при помощи Optuna гиперпараметрами. Проведен анализ важности признаков для моделей.


## Описание данных 

**Признаки:**

- `DateCrawled` — дата скачивания анкеты из базы
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л. с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была машина в ремонте или нет
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий автомобиля
- `PostalCode` — почтовый индекс владельца анкеты (пользователя)
- `LastSeen` — дата последней активности пользователя

**Целевой признак:**

- `Price` — цена (евро)

## Итоговый вывод

Среди линейных моделей лучший результат показала Ridge-регрессия, однако, она не преодолела порогового значения точности результата. Время обучения и время предсказания у нее самые быстрые.

Фреймворк LightGBM показал лучшую точность среди сравниваемых моделей и относительно недолгое время обучения (модель обучается в 19 раз быстрее CatBoost).

Модель на основе CatBoost достигла неплохого качества на валидационной выборке, а время предсказания у нее сравнимо с Ridge-регреcсией и составляет менее 1 с.

На тестовой выборке модель LightGBM также показала себя хорошо, значение метрики незначительно улучшилось по сравнению с валидационной выборкой.

Таким образом, по совокупности параметров оптимальной моделью для заказчика выглядит LightGBM.
