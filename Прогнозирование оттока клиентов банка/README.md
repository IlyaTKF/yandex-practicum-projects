# Прогнозирование оттока клиентов банка

## Задача проекта

Из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
На основе исторических данных о поведении клиентов и расторжении договоров с банком нужно спрогнозировать, уйдёт клиент в ближайшее время или нет. 

## Описание данных

**Признаки:**
* `RowNumber` — индекс строки в данных
* `CustomerId` — уникальный идентификатор клиента
* `Surname` — фамилия
* `CreditScore` — кредитный рейтинг
* `Geography` — страна проживания
* `Gender` — пол
* `Age` — возраст
* `Tenure` — сколько лет человек является клиентом банка
* `Balance` — баланс на счёте
* `NumOfProducts` — количество продуктов банка, используемых клиентом
* `HasCrCard` — наличие кредитной карты
* `IsActiveMember` — активность клиента
* `EstimatedSalary` — предполагаемая зарплата

**Целевой признак:**

* `Exited` — факт ухода клиента
  
## Описание проекта

На первом этапе была проведена предобработка данных, заполнены пропуски в данных (с помощью алгоритма KNNImputer). Категориальные признаки переведены в численные техникой прямого кодирования (OHE). Столбцы с разным масштабом были стандартизированы с помощью StandardScaler. 

При анализе данных была отмечена проблема дисбаланса классов, которую мы попытались решить с помощью:

- настройки гиперпараметров;
- upsampling-а;
- downsampling-а;
- изменения порога классификации.

Для решения задачи классификации тестировались следующие модели:

- Decision Tree;
- Random Forest;
- Logistic Regression.

Для определения лучшей модели сравнивались значения F1-меры, AUC-ROC метрики и матрицы ошибок.

## Итоговый вывод

По результатам тестирования для решения задачи классификации клиентов банка была выбрана модель случайного леса, обученная на изменненой с помощью upsampling выборке. Модель прошла проверку на адекватность, значение f1-метрики на тестовой выборке превысило пороговое и составило 0.6.
